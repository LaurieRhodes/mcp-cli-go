$schema: "workflow/v2.0"
name: security_analysis
version: 1.0.0
description: Focused security vulnerability analysis

execution:
  provider: anthropic
  model: claude-sonnet-4
  temperature: 0.3

steps:
  - name: vulnerability_scan
    run: |
      Perform security vulnerability analysis on this code:
      
      {{code}}
      
      {% if review %}
      Previous Review Context:
      {{review}}
      {% endif %}
      
      Scan for:
      1. **Injection Vulnerabilities**
         - SQL injection
         - Command injection
         - LDAP injection
      
      2. **Cross-Site Scripting (XSS)**
         - Reflected XSS
         - Stored XSS
         - DOM-based XSS
      
      3. **Authentication & Authorization**
         - Weak authentication
         - Session management issues
         - Access control problems
      
      4. **Sensitive Data Exposure**
         - Hardcoded credentials
         - Unencrypted sensitive data
         - Information leakage
      
      5. **Cryptography Issues**
         - Weak encryption
         - Improper key management
         - Insecure random generation
      
      6. **Input Validation**
         - Missing validation
         - Improper sanitization
         - Buffer overflows
      
      For each vulnerability:
      - **Severity**: CRITICAL / HIGH / MEDIUM / LOW
      - **Location**: Line numbers or function names
      - **Description**: What the vulnerability is
      - **Impact**: Potential consequences
      - **Exploit Scenario**: How it could be exploited
      - **Remediation**: Specific fix required
      
      Provide security score (1-10) where:
      - 10 = No vulnerabilities found
      - 7-9 = Minor issues only
      - 4-6 = Moderate concerns
      - 1-3 = Critical vulnerabilities present
      
      Format clearly with severity-ordered findings.
