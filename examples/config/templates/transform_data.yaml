name: transform_data
description: "Demonstrates data transformation operations"
version: 1.0.0

metadata:
  category: phase2
  tags:
    - transform
    - data-manipulation
    - demo
  author: Dev Team

config:
  variables:
    sample_data: |
      [
        {"name": "Project A", "priority": "high", "status": "active", "score": 95},
        {"name": "Project B", "priority": "low", "status": "active", "score": 60},
        {"name": "Project C", "priority": "high", "status": "completed", "score": 88},
        {"name": "Project D", "priority": "medium", "status": "active", "score": 75},
        {"name": "Project E", "priority": "high", "status": "paused", "score": 92}
      ]
  
  defaults:
    provider: openai
    model: gpt-4o-mini
    temperature: 0.3

steps:
  # Step 1: Filter high priority active projects
  - name: filter_high_priority
    description: "Filter for high priority active projects"
    
    transform:
      input: sample_data
      operations:
        - type: filter
          condition: "priority == 'high'"
        - type: filter
          condition: "status == 'active'"
        - type: limit
          count: 10
    
    output: filtered_projects
  
  # Step 2: Analyze filtered projects
  - name: analyze_projects
    description: "Analyze the filtered projects"
    depends_on:
      - filter_high_priority
    
    prompt: |
      Analyze these high-priority active projects:
      {{filtered_projects}}
      
      Provide:
      1. Overview of projects
      2. Priority recommendations
      3. Resource allocation suggestions
    
    servers: []
    output: project_analysis
  
  # Step 3: Extract just project names
  - name: extract_names
    description: "Extract project names for reporting"
    
    transform:
      input: filtered_projects
      operations:
        - type: pluck
          key: name
    
    output: project_names
  
  # Step 4: Final report
  - name: final_report
    description: "Generate final report"
    depends_on:
      - analyze_projects
      - extract_names
    
    prompt: |
      Create a concise executive summary:
      
      Projects: {{project_names}}
      Analysis: {{project_analysis}}
      
      Format as brief bullet points.
    
    servers: []
    output: summary
